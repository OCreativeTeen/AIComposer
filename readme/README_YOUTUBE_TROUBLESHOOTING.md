# YouTube ä¸‹è½½æ•…éšœæ’é™¤æŒ‡å—

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 1. JavaScript æŒ‘æˆ˜å¤±è´¥è­¦å‘Š

**ç—‡çŠ¶:**
```
WARNING: [youtube] xxxxx: n challenge solving failed: Some formats may be missing.
Ensure you have a supported JavaScript runtime and challenge solver script distribution installed.
```

**åŸå› :**
YouTube ä½¿ç”¨ JavaScript æŒ‘æˆ˜æ¥é˜²æ­¢è‡ªåŠ¨åŒ–è®¿é—®,éœ€è¦ Node.js è¿è¡Œæ—¶æ¥è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚

**è§£å†³æ–¹æ¡ˆ:**

#### Windows å®‰è£… Node.js

**æ–¹æ³• 1: å®˜æ–¹å®‰è£…ç¨‹åº (æ¨è)**
1. è®¿é—® https://nodejs.org/
2. ä¸‹è½½ LTS ç‰ˆæœ¬ (Long Term Support)
3. è¿è¡Œå®‰è£…ç¨‹åº
4. **é‡è¦**: ç¡®ä¿é€‰ä¸­ "Add to PATH" é€‰é¡¹
5. å®‰è£…å®Œæˆå,**å…³é—­å¹¶é‡æ–°æ‰“å¼€æ‰€æœ‰ç»ˆç«¯çª—å£**
6. é‡å¯ Python åº”ç”¨ç¨‹åº

**æ–¹æ³• 2: ä½¿ç”¨ Chocolatey**
```powershell
choco install nodejs
```

**æ–¹æ³• 3: ä½¿ç”¨ Winget**
```powershell
winget install OpenJS.NodeJS
```

**éªŒè¯å®‰è£…:**
æ‰“å¼€æ–°çš„å‘½ä»¤æç¤ºç¬¦æˆ– PowerShell çª—å£:
```bash
node --version
npm --version
```
åº”è¯¥çœ‹åˆ°ç‰ˆæœ¬å·è¾“å‡º(ä¾‹å¦‚ `v20.11.0`)

---

### 2. HTTP 403 Forbidden é”™è¯¯

**ç—‡çŠ¶:**
```
[download] Got error: HTTP Error 403: Forbidden
ERROR: [youtube] xxxxx: Requested format is not available.
```

**åŸå› :**
- YouTube æ£€æµ‹åˆ°è‡ªåŠ¨åŒ–è®¿é—®å¹¶é˜»æ­¢äº†è¯·æ±‚
- æŸäº›è§†é¢‘æ ¼å¼å—åœ°åŒºé™åˆ¶æˆ–éœ€è¦ç™»å½•

**è§£å†³æ–¹æ¡ˆ:**

#### æ­¥éª¤ 1: ç¡®ä¿ä½¿ç”¨ Cookies
å‚è€ƒ `README_YOUTUBE_COOKIES.md` æ–‡æ¡£,ç¡®ä¿æ­£ç¡®é…ç½®äº† `www.youtube.com_cookies.txt` æ–‡ä»¶ã€‚

#### æ­¥éª¤ 2: æ›´æ–° yt-dlp
```powershell
cd D:\AIComposer
.\venv\Scripts\python.exe -m pip install -U yt-dlp
```

#### æ­¥éª¤ 3: å®‰è£… Node.js (è§ä¸Šæ–¹)

#### æ­¥éª¤ 4: ä½¿ç”¨æ”¹è¿›çš„ä¸‹è½½ç­–ç•¥
æœ€æ–°ç‰ˆæœ¬çš„ä»£ç å·²ç»åŒ…å«äº†æ›´çµæ´»çš„æ ¼å¼é€‰æ‹©ç­–ç•¥:
- ä¼˜å…ˆå°è¯• MP4 é«˜è´¨é‡æ ¼å¼
- è‡ªåŠ¨é™çº§åˆ°å¯ç”¨æ ¼å¼
- æœ€åä½¿ç”¨æœ€åŸºç¡€çš„ 'best' æ ¼å¼

---

### 3. æ ¼å¼ä¸å¯ç”¨é”™è¯¯

**ç—‡çŠ¶:**
```
ERROR: [youtube] xxxxx: Requested format is not available.
Use --list-formats for a list of available formats
```

**åŸå› :**
è¯·æ±‚çš„ç‰¹å®šæ ¼å¼ç»„åˆä¸å¯ç”¨(ä¾‹å¦‚æŸäº›è§†é¢‘æ²¡æœ‰ç‹¬ç«‹çš„è§†é¢‘+éŸ³é¢‘æµ)ã€‚

**è§£å†³æ–¹æ¡ˆ:**
ä»£ç å·²æ›´æ–°ä¸ºä½¿ç”¨çµæ´»çš„æ ¼å¼é™çº§ç­–ç•¥:

1. **é¦–é€‰**: `bestvideo[ext=mp4][height<=1080]+bestaudio[ext=m4a]` (1080p MP4 + M4A)
2. **å¤‡é€‰**: `bestvideo[ext=mp4]+bestaudio[ext=m4a]` (ä»»ä½• MP4 + M4A)
3. **å¤‡é€‰**: `bestvideo[height<=1080]+bestaudio` (1080p è§†é¢‘ + éŸ³é¢‘)
4. **å¤‡é€‰**: `bestvideo+bestaudio` (æœ€ä½³è§†é¢‘ + éŸ³é¢‘)
5. **å¤‡é€‰**: `best[ext=mp4][height<=1080]` (å•æ–‡ä»¶ MP4 1080p)
6. **å¤‡é€‰**: `best[ext=mp4]` (ä»»ä½•å•æ–‡ä»¶ MP4)
7. **æœ€åå¤‡é€‰**: `best` (æœ€ä½³å¯ç”¨æ ¼å¼)

å¦‚æœä¸»ç­–ç•¥å¤±è´¥,ä»£ç ä¼šè‡ªåŠ¨ä½¿ç”¨ `best` æ ¼å¼é‡è¯•ã€‚

---

### 4. è§†é¢‘ä¸‹è½½åæ‰¾ä¸åˆ°æ–‡ä»¶

**ç—‡çŠ¶:**
ä¸‹è½½è¿‡ç¨‹æ˜¾ç¤ºæˆåŠŸ,ä½†ç¨‹åºæŠ¥å‘Šæ‰¾ä¸åˆ°ä¸‹è½½çš„æ–‡ä»¶ã€‚

**è§£å†³æ–¹æ¡ˆ:**
ä»£ç å·²æ›´æ–°ä¸ºåœ¨æ‰¾ä¸åˆ°é¢„æœŸçš„ `.mp4` æ–‡ä»¶æ—¶,è‡ªåŠ¨æœç´¢å…¶ä»–æ ¼å¼:
- `.webm`
- `.mkv`
- `.mp4`

---

### 5. éƒ¨åˆ†è§†é¢‘ä¸‹è½½å¤±è´¥

**ç—‡çŠ¶:**
æ‰¹é‡ä¸‹è½½æ—¶,æŸäº›è§†é¢‘æˆåŠŸ,æŸäº›å¤±è´¥å¹¶æ˜¾ç¤ºä¸Šè¿°é”™è¯¯ã€‚

**åŸå› :**
- ä¸åŒè§†é¢‘å¯èƒ½æœ‰ä¸åŒçš„å¯ç”¨æ ¼å¼
- æŸäº›è§†é¢‘å¯èƒ½æœ‰åœ°åŒºé™åˆ¶
- æŸäº›è§†é¢‘å¯èƒ½æ˜¯ä¼šå‘˜ä¸“å±æˆ–éœ€è¦ä»˜è´¹

**è§£å†³æ–¹æ¡ˆ:**

1. **æ£€æŸ¥è§†é¢‘å¯è®¿é—®æ€§**:
   - åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨è®¿é—®è§†é¢‘
   - ç¡®è®¤å¯ä»¥æ­£å¸¸æ’­æ”¾
   - æ£€æŸ¥æ˜¯å¦éœ€è¦ä¼šå‘˜æˆ–ä»˜è´¹

2. **æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯**:
   åº”ç”¨ç¨‹åºä¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯,åŒ…å«:
   - `âš ï¸ è·³è¿‡è§†é¢‘`: è§†é¢‘å› æŸç§åŸå› è¢«è·³è¿‡
   - `âŒ å¤‡ç”¨æ–¹æ¡ˆä¹Ÿå¤±è´¥`: æ‰€æœ‰æ ¼å¼éƒ½å°è¯•å¤±è´¥

3. **ç»§ç»­ä¸‹è½½å…¶ä»–è§†é¢‘**:
   æ‰¹é‡ä¸‹è½½åŠŸèƒ½ä¼šè‡ªåŠ¨è·³è¿‡å¤±è´¥çš„è§†é¢‘,ç»§ç»­å¤„ç†åˆ—è¡¨ä¸­çš„å…¶ä»–è§†é¢‘ã€‚

---

### 6. æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### é™ä½è§†é¢‘è´¨é‡è¦æ±‚
å¦‚æœç»å¸¸é‡åˆ°æ ¼å¼ä¸å¯ç”¨é”™è¯¯,å¯ä»¥ä¿®æ”¹æ ¼å¼å­—ç¬¦ä¸²,åªè¯·æ±‚è¾ƒä½è´¨é‡:

```python
format_string = 'best[height<=720]/best'  # åªè¯·æ±‚ 720p æˆ–æ›´ä½
```

#### åˆ†æ‰¹ä¸‹è½½
å¯¹äºå¤§é‡è§†é¢‘:
- å»ºè®®åˆ†æ‰¹ä¸‹è½½(æ¯æ¬¡ 10-20 ä¸ª)
- é¿å…ä¸€æ¬¡æ€§ä¸‹è½½è¿‡å¤šè§†é¢‘å¯¼è‡´è¢«é™æµ

#### ä½¿ç”¨ä»£ç†(å¯é€‰)
å¦‚æœé‡åˆ°åœ°åŒºé™åˆ¶,å¯ä»¥è€ƒè™‘ä½¿ç”¨ä»£ç†:
```python
ydl_opts = self._get_ydl_opts_base(
    proxy='http://your-proxy:port',
    ...
)
```

---

## å®Œæ•´æ£€æŸ¥æ¸…å•

é‡åˆ°ä¸‹è½½é—®é¢˜æ—¶,è¯·æŒ‰é¡ºåºæ£€æŸ¥:

- [ ] **å®‰è£… Node.js** (è§£å†³ JavaScript æŒ‘æˆ˜)
- [ ] **é…ç½® Cookies** (å‚è€ƒ `README_YOUTUBE_COOKIES.md`)
- [ ] **æ›´æ–° yt-dlp** (`python -m pip install -U yt-dlp`)
- [ ] **é‡å¯åº”ç”¨ç¨‹åº** (ä½¿æ›´æ”¹ç”Ÿæ•ˆ)
- [ ] **æµ‹è¯•å•ä¸ªè§†é¢‘** (ç¡®è®¤åŸºæœ¬åŠŸèƒ½æ­£å¸¸)
- [ ] **æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º** (è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯)
- [ ] **æ£€æŸ¥ç½‘ç»œè¿æ¥** (ç¡®ä¿å¯ä»¥è®¿é—® YouTube)
- [ ] **éªŒè¯è§†é¢‘å¯è®¿é—®æ€§** (åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨æ’­æ”¾)

---

## è·å–æ›´å¤šå¸®åŠ©

å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜:

1. **æŸ¥çœ‹å®Œæ•´é”™è¯¯æ—¥å¿—**:
   - æ‰“å¼€ Python Debug Console
   - å¤åˆ¶å®Œæ•´çš„é”™è¯¯å †æ ˆä¿¡æ¯

2. **æ£€æŸ¥ yt-dlp å®˜æ–¹æ–‡æ¡£**:
   - https://github.com/yt-dlp/yt-dlp
   - https://github.com/yt-dlp/yt-dlp/wiki/EJS

3. **æµ‹è¯• yt-dlp å‘½ä»¤è¡Œ**:
   ```bash
   cd D:\AIComposer
   .\venv\Scripts\yt-dlp.exe --cookies www.youtube.com_cookies.txt --list-formats "VIDEO_URL"
   ```
   è¿™å¯ä»¥å¸®åŠ©ç¡®å®šé—®é¢˜æ˜¯å¦åœ¨ yt-dlp å±‚é¢è¿˜æ˜¯åº”ç”¨ç¨‹åºå±‚é¢ã€‚

---

## æ—¥å¿—è§£è¯»

### æ­£å¸¸æ—¥å¿—ç¤ºä¾‹
```
âœ… æ‰¾åˆ° cookies æ–‡ä»¶: /AI_MEDIA/project/xxx/www.youtube.com_cookies.txt
ğŸ“Š Cookies æ–‡ä»¶å¤§å°: 3053 å­—èŠ‚
ğŸ” è·å–é¢‘é“è§†é¢‘åˆ—è¡¨: https://www.youtube.com/@channel/videos
[youtube:tab] Extracting URL: ...
[youtube:tab] @channel/videos: Downloading webpage
[download] Downloading playlist: Channel Name - Videos
âœ… æˆåŠŸè·å– 100 ä¸ªè§†é¢‘
```

### è­¦å‘Šæ—¥å¿—(å¯ç»§ç»­)
```
WARNING: [youtube] xxxxx: n challenge solving failed
âš ï¸ è·³è¿‡è§†é¢‘: ERROR: [youtube] xxxxx: Requested format is not available
```
è¿™äº›è­¦å‘Šè¡¨ç¤ºæŸäº›è§†é¢‘è·³è¿‡äº†,ä½†å…¶ä»–è§†é¢‘å¯ä»¥ç»§ç»­ä¸‹è½½ã€‚

### é”™è¯¯æ—¥å¿—(éœ€å¤„ç†)
```
âŒ è·å–è§†é¢‘åˆ—è¡¨å¤±è´¥: Sign in to confirm you're not a bot
ERROR: Failed to decrypt with DPAPI
```
è¿™äº›é”™è¯¯è¡¨ç¤ºéœ€è¦é‡‡å–è¡ŒåŠ¨(é…ç½® cookies ç­‰)ã€‚

---

**æœ€åæ›´æ–°**: 2026-01-18
