# Magic Tool - 综合工具集

## 概述

Magic Tool 是一个综合性的工具集，集成了 YouTube 视频转录、缩略图生成和音频转录功能，现已支持项目配置管理，可与主工作流系统无缝集成。

## 🆕 新功能特性 (v2.0)

### 项目配置管理
- **项目选择和创建**: 启动时自动显示项目选择对话框
- **项目信息管理**: 支持 PID、频道、语言、标题和关键字配置
- **配置自动保存**: 项目设置自动保存到配置文件
- **多项目支持**: 可在不同项目间快速切换
- **与主工作流集成**: 使用相同的项目配置系统

## 功能特性

### 1. YouTube 视频转录
- 支持 YouTube 链接转录
- 多语言源语言检测 (auto, en, zh, ja, ko, es, fr, de, ru, ar, hi, pt)
- 可选的目标语言翻译
- 强制刷新选项
- 实时转录状态显示

### 2. 缩略图生成
- 支持多种图片格式 (PNG, JPG, JPEG, BMP, GIF, TIFF, WEBP)
- 多语言字体支持 (简体中文、繁體中文、英文)
- 可调节字体大小
- 自动字体选择基于当前语言设置
- 实时生成状态显示

### 3. 音频转录
- **拖拽支持**: 支持音频文件拖拽上传
- **多格式支持**: 支持 MP3, WAV, M4A, FLAC 等音频格式
- **Whisper 转录**: 使用高精度 Whisper 模型进行转录
- **字幕生成**: 自动生成 SRT 字幕文件和纯文本文件
- **实时转录**: 实时显示转录进度和状态

### 4. 多语言支持
- 操作语言: 简体中文 (zh)、繁體中文 (tw)、英文 (en)
- 字体自动切换基于语言设置
- 界面语言自适应

## 使用方法

### 启动方式

1. **通过主程序启动**
   ```bash
   python main.py
   # 然后选择 "工具" -> "综合工具集"
   ```

2. **直接启动**
   ```bash
   python run_magic_tool.py
   ```

3. **独立运行**
   ```bash
   python magic_tool.py
   ```

### 操作步骤

#### 🆕 项目配置 (首次启动)
1. **项目选择**: 启动时会自动显示项目选择对话框
2. **创建新项目**: 
   - 点击"新建项目"
   - 输入项目ID (PID)
   - 选择频道和语言
   - 输入项目标题
   - 设置关键字 (可选)
3. **打开现有项目**: 从列表中选择已有项目
4. **项目管理**: 运行时可点击"选择项目"按钮切换项目

#### YouTube 转录
1. 切换到 "YouTube转录" 标签页
2. 输入 YouTube 视频链接
3. 选择源语言 (建议使用 "auto" 自动检测)
4. 选择目标语言 (可选，留空表示不翻译)
5. 根据需要勾选 "强制刷新"
6. 点击 "开始转录"
7. 在输出日志中查看转录进度和结果

#### 缩略图生成
1. 切换到 "缩略图生成" 标签页
2. 选择背景图片文件
3. 输入标题文字
4. 选择字体 (基于当前语言自动筛选)
5. 调整字体大小
6. 点击 "生成缩略图"
7. 在输出日志中查看生成进度和结果

#### 🆕 音频转录
1. 切换到 "音频转录" 标签页
2. **方式一 - 拖拽上传**: 直接将音频文件拖拽到拖拽区域
3. **方式二 - 文件选择**: 点击"选择音频文件"按钮
4. 选择音频文件后，点击"开始转录"
5. 系统会自动生成:
   - `.srt` 字幕文件 (带时间戳)
   - `.txt` 纯文本文件
6. 在输出日志中查看转录进度和结果

#### 语言设置
1. 在顶部语言设置区域选择操作语言
2. 字体选项会自动更新
3. 所有输出日志会显示语言切换信息

## 技术特性

### 线程安全
- 所有耗时操作都在后台线程中执行
- GUI 界面保持响应性
- 实时状态更新和进度显示

### 错误处理
- 完善的输入验证
- 详细的错误信息显示
- 异常捕获和用户友好的错误提示

### 配置管理
- 基于 `config.py` 的字体配置
- 语言相关的字体自动选择
- 可扩展的配置系统

## 文件结构

```
GUI_Magic_Tool.py      # 🆕 主工具 GUI (集成项目管理)
magic_tool.py          # 主工具类 (已弃用，保留兼容性)
run_magic_tool.py      # 启动脚本
main.py               # 主程序 (包含工具菜单)
project_manager.py     # 🆕 项目配置管理器 (可重用)
config.py             # 配置文件 (字体、路径等)
config/               # 🆕 项目配置文件目录
  ├── *.config        # 各项目配置文件
```

## 依赖项

- `tkinter` - GUI 框架
- `threading` - 多线程支持
- `magic_workflow` - 核心工作流
- `config` - 配置管理
- `project_manager` - 🆕 项目配置管理
- `uuid` - 任务 ID 生成
- `datetime` - 时间戳
- `tkinterdnd2` - 🆕 拖拽支持 (可选)

## 配置说明

### 字体配置
字体配置在 `config.py` 中定义：

```python
FONTS_BY_LANGUAGE = {
    "zh": [FONT_0, FONT_1, FONT_4, FONT_6, FONT_7],  # 简体中文字体
    "tw": [FONT_2, FONT_8, FONT_9],                   # 繁體中文字体
    "en": [...]                                        # 英文字体 (可扩展)
}
```

### 路径配置
- `PUBLISH_PATH` - 输出文件保存路径
- `BASE_MEDIA_PATH` - 媒体文件基础路径

## 故障排除

### 常见问题

1. **字体显示异常**
   - 检查 `config.py` 中的字体路径配置
   - 确保字体文件存在且可访问

2. **转录失败**
   - 检查网络连接
   - 验证 YouTube 链接有效性
   - 查看详细错误日志

3. **缩略图生成失败**
   - 检查图片文件是否存在
   - 验证输出路径权限
   - 确保 FFmpeg 配置正确

### 日志查看
所有操作日志都会在对应的输出区域显示，包括：
- 操作开始时间
- 详细进度信息
- 成功/失败状态
- 错误详情

## 扩展开发

### 添加新功能
1. 在 `MagicTool` 类中添加新的标签页方法
2. 实现相应的功能逻辑
3. 更新 UI 和事件处理
4. 添加错误处理和日志记录

### 添加新语言支持
1. 在 `config.py` 中添加新语言的字体配置
2. 更新语言选择器
3. 添加相应的界面文本翻译

## 版本历史

### v2.0 (当前版本) - 🆕 项目管理集成版
- **新增项目配置管理**: 支持项目选择、创建和切换
- **新增音频转录功能**: 支持拖拽上传和 Whisper 转录
- **项目配置持久化**: 自动保存和恢复项目设置
- **与主工作流集成**: 使用统一的项目配置系统
- **增强用户体验**: 项目信息实时显示和自动保存

### v1.0 - 初始版本
- 基础转录和缩略图功能
- 多语言操作支持
- 集成到主程序菜单系统 