# 视觉效果增强功能

## 概述

在 create_video_tab（生成视频标签页）中，我们新增了视觉效果增强功能，可以对当前场景的MP4视频应用各种炫酷的视觉效果。

## 功能特性

### ✨ 发光效果 (Glow Effect)
- 为视频添加发光效果，让画面更加璀璨
- 使用 FFmpeg 的 unsharp 和 blend 滤镜实现
- 可调节发光强度和半径

### 🌊 漂浮动画 (Floating Animation)
- 添加轻柔的漂浮动画，让视频更有动感
- 使用数学函数创建正弦波运动
- 可调节漂浮幅度和速度

### 🎯 模糊聚焦 (Blur Focus)
- 创建背景模糊、前景聚焦的景深效果
- 使用径向渐变蒙版实现平滑过渡
- 可调节聚焦区域大小和模糊强度

### 💨 亮度呼吸 (Brightness Breathing)
- 添加亮度呼吸效果，模拟呼吸般的亮度变化
- 使用正弦波函数控制亮度周期性变化
- 可调节呼吸速度、变化范围和基础亮度

### 🎨 组合效果 (Combined Effects)
- 同时应用多种效果的组合
- 预设了发光+漂浮+呼吸的组合效果
- 效果按顺序叠加应用

### 🔄 重置原视频
- 恢复到原始视频（无任何效果）
- 如果原始视频不存在，会重新生成

## 使用方法

1. **选择场景**: 在视频标签页中导航到要增强的场景
2. **选择效果**: 点击右侧面板中的效果按钮
3. **自动处理**: 系统会自动应用效果并延长视频到音频长度
4. **实时预览**: 处理完成后可在视频预览区域查看效果

## 技术实现

### 视频长度自动匹配
- 如果当前视频长度小于场景音频长度，会自动延长视频
- 延长方式：在开头添加第一帧静态画面，必要时在结尾添加最后一帧

### 文件命名规则
- 增强后的视频文件名格式：`原文件名_enhanced_效果名.mp4`
- 例如：`scenario_1_enhanced_glow.mp4`

### 错误处理
- 自动检测视频和音频文件是否存在
- 处理过程中的错误会在操作日志中显示
- 支持任务状态跟踪

## 效果参数

### 发光效果参数
```python
{
    'glow': {
        'enabled': True,
        'intensity': 1.8,  # 发光强度 (0.5-3.0)
        'radius': 8        # 发光半径 (1-20)
    }
}
```

### 漂浮动画参数
```python
{
    'floating': {
        'enabled': True,
        'amplitude': 20,   # 漂浮幅度（像素）
        'speed': 1.5       # 漂浮速度（周期/秒）
    }
}
```

### 模糊聚焦参数
```python
{
    'blur_focus': {
        'enabled': True,
        'focus_ratio': 0.6,      # 聚焦区域比例 (0.3-0.8)
        'blur_strength': 12      # 模糊强度 (1-20)
    }
}
```

### 亮度呼吸参数
```python
{
    'breathing': {
        'enabled': True,
        'speed': 0.8,       # 呼吸速度（周期/秒）
        'range': 0.25,      # 亮度变化范围 (-1.0 到 1.0)
        'base': 0.1         # 基础亮度 (-1.0 到 1.0)
    }
}
```

## 注意事项

- 效果处理需要一定时间，请耐心等待
- 建议在应用效果前保存项目配置
- 大视频文件处理时间会较长
- 确保有足够的磁盘空间存储增强后的视频

## 未来扩展

可以很容易地添加更多视觉效果：
- 色彩滤镜
- 粒子效果  
- 动态边框
- 文字动画
- 转场效果

---

*此功能基于 FFmpeg 的强大视频处理能力实现，为视频内容创作提供专业级的视觉增强效果。* 